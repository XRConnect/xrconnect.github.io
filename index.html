<script>
  document.addEventListener('DOMContentLoaded', () => {
    // ÏÑ†ÌÉù Î≤ÑÌäº ÌÜ†Í∏Ä
    document.querySelectorAll('.options').forEach(container => {
      container.addEventListener('click', (ev) => {
        const btn = ev.target.closest('.option-btn');
        if (!btn) return;
        btn.classList.toggle('active');
      });
    });

    // Ï†úÏ∂ú Ï≤òÎ¶¨
    const form = document.getElementById('projectForm');
    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      // 1) Í∏∞Î≥∏ ÏûÖÎ†•Í∞í ÏàòÏßë
      const formData = new FormData(form);
      const data = {};
      formData.forEach((v, k) => data[k] = v);

      // 2) ÏÑ†ÌÉù Î≤ÑÌäº Í∞í ÏàòÏßë
      document.querySelectorAll('.options[data-group]').forEach(container => {
        const key = container.dataset.group;
        const vals = [...container.querySelectorAll('.option-btn.active')]
          .map(x => x.textContent.trim());
        data[key] = vals.join(', ');
      });

      console.log('[SEND DATA]', data);

      // 3) GAS URL (Î∞∞Ìè¨Ìïú Ïõπ Ïï± Ï£ºÏÜå)
      const GAS_URL = "https://script.google.com/macros/s/AKfycbxauxN_xD19rAW66gBSc0CwzLMCjQFNPHa0T6q2-wzzwfNcn_zZupIypQXBuSReHq3xzw/exec";

      try {
        // ÏöîÏ≤≠ Î≥¥ÎÇ¥Í∏∞ (no-cors Î™®Îìú ‚Üí ÏùëÎãµÏùÄ ÌôïÏù∏ Î∂àÍ∞Ä)
        await fetch(GAS_URL, {
          method: 'POST',
          mode: 'no-cors',   // üëà Ïù¥Í±∞ ÎçïÎ∂ÑÏóê Failed to fetch Ïïà Îú∏
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });

        // ÏÑ±Í≥µ Î©îÏãúÏßÄ ÎùÑÏö∞Í∏∞
        alert('‚úÖ Îì±Î°ù ÏöîÏ≤≠ ÏôÑÎ£å! (ÏãúÌä∏/SlackÏóêÏÑú ÌôïÏù∏ÌïòÏÑ∏Ïöî)');

        // Ìèº Ï¥àÍ∏∞Ìôî
        form.reset();
        document.querySelectorAll('.option-btn.active').forEach(el => el.classList.remove('active'));
      } catch (err) {
        console.error('[SEND ERROR]', err);
        alert('‚ö†Ô∏è ÏÑúÎ≤Ñ Ïò§Î•ò: ' + err.message);
      }
    });
  });
</script>
