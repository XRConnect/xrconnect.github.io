<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>XR Connect - 문의</title>
  <style>
  :root{
    --text:#252525; --border:#bbb; --bg:#fff; --dark:#707070; --muted:#707070;
  }
  *{ box-sizing:border-box }
  body{
    margin:0; background:var(--bg); color:var(--text);
    font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
  }
  .container{ max-width:1200px; margin:0 auto; }

  /* 레이아웃 */
  .wrap{ display:grid; grid-template-columns:480px 1fr; gap:48px; align-items:flex-start; }
  .section{ padding:80px 20px; 40px; }
  .left{ display:flex; align-items:center; gap:16px; width:480px; }
  .step{
    width:36px; height:36px; border-radius:50%; background:#252525; color:#fff;
    display:grid; place-items:center; font-weight:700;
  }
  .left h2{ margin:0; font-size:24px; font-weight:700; letter-spacing:-0.02em; }
  .help{ margin:0 0 16px; color:var(--muted); font-size:14px; }
  .title-wrap{ display:flex; flex-direction:column; justify-content:center; align-items:flex-start; gap:16px; }

  /* 입력 공통 */
  .group label{ display:block; margin-bottom:16px; font-weight:700; font-size:16px; }
  .input{
    width:100%; height:48px; padding:0 16px; font-size:14px;
    border:1px solid var(--border); border-radius:12px; outline:none;
    transition:border-color .15s, box-shadow .15s;
    background:#fff;
  }
  .input::placeholder{ color:#bbb; }
  .input:focus{ border:2px solid #252525; box-shadow:0 0 0 4px rgba(0,0,0,.06); }

  /* Flatpickr altInput도 같은 룩 */
  input.flatpickr-input.input{
    background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="%23707070" viewBox="0 0 24 24"><path d="M7 2a1 1 0 0 1 1 1v1h8V3a1 1 0 1 1 2 0v1h1a2 2 0 0 1 2 2v13a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h1V3a1 1 0 0 1 1-1zm-2 6v11h14V8H5z"/></svg>');
    background-repeat:no-repeat; background-position:calc(100% - 14px) 50%; padding-right:44px;
  }

  /* 검증 */
  .input.user-touched:invalid,
  form.was-validated .input:invalid{ border-color:#ef4444; box-shadow:0 0 0 4px rgba(239,68,68,.12); }

  /* 목적 타일 */
  .tiles{ display:grid; grid-template-columns:repeat(3, minmax(0,1fr)); gap:12px; }
  .tile{
    border:1px solid var(--border); border-radius:16px; padding:16px; height:160px;
    display:flex; flex-direction:column; align-items:center; justify-content:center; text-align:center;
    cursor:pointer; user-select:none; font-weight:500;
    transition:border-color .15s, background .15s, color .15s, transform .05s;
  }
  .tile:active{ transform:scale(.99); }
  .tile .icon{ display:inline-flex; align-items:center; justify-content:center; width:56px; height:57px; margin-bottom:8px; }
  .tile .icon img{ width:100%; height:100%; object-fit:contain; vertical-align:middle; }
  .tile .label{ font-size:16px; }
  .tile.active{ background:#252525; color:#fff; border-color:#252525; }
  .group[data-name="purpose"] .tiles{ display:grid!important; grid-template-columns:repeat(3,minmax(0,1fr))!important; gap:12px; }

  /* 칩 */
  .chips{ display:flex; flex-wrap:wrap; gap:8px; }
  .chip{
    border:1px solid var(--border); border-radius:999px; padding:12px 16px; cursor:pointer; user-select:none;
    font-weight:500; font-size:14px; line-height:1;
    transition:border-color .15s, background .15s, color .15s, transform .05s;
  }
  .chip:active{ transform:scale(.98); }
  .chip.active{ background:#252525; color:#fff; border-color:#707070; }

  /* 섹션4 레이아웃 */
  .field-stack{ display:flex; flex-direction:column; }
  .row-2col{ display:grid; grid-template-columns:repeat(2, minmax(0,1fr)); column-gap:16px; row-gap:16px; }
  .group{ margin-bottom:40px; }
  .group h3{ font-size:16px; font-weight:700; margin-top:0 !important; }
  .textarea{
    width:100%; min-height:120px; padding:16px; border:1px solid var(--border); border-radius:16px; font-family:Inter, sans-serif; font-size:14px;
  }
  .textarea::placeholder{ color:#bbb; }
  .textarea:focus{ border-color:#252525; box-shadow:0 0 0 4px rgba(0,0,0,.06); }

  /* 네이티브 select(커스텀 제외) */
  select.input:not([data-enhance="select"]){
    -webkit-appearance:none; appearance:none;
    width:100%; height:48px; padding:0 48px 0 16px;
    font-size:14px; line-height:1; border:1px solid var(--border);
    border-radius:12px; outline:none; background:#fff;
    background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="%23707070" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>');
    background-repeat:no-repeat; background-position:right 14px center; background-size:20px 20px;
    transition:border-color .15s, box-shadow .15s, background-color .15s; cursor:pointer; color:var(--text);
  }

  /* ===== Custom Select ===== */
  .cs{ position:relative; width:100%; }
  /* 네이티브 select는 완전히 숨긴 채 값만 가져감 */
  .cs select{
    position:absolute; inset:0; width:100%; height:100%;
    opacity:0 !important; pointer-events:none !important; z-index:0 !important;
    -webkit-appearance:none !important; appearance:none !important;
  }

  /* 트리거(닫힌 상태) */
  .cs-trigger{
    position:relative; z-index:1;
    width:100%; height:48px;
    display:flex; align-items:center; justify-content:space-between;
    padding:0 16px; font-size:14px; line-height:1;
    border:1px solid var(--border); border-radius:12px; background:#fff;
    cursor:pointer; transition:border-color .15s, box-shadow .15s;
  }
  .cs-trigger:hover{ border-color:#999; }
  .cs-trigger:focus{ outline:none; border:2px solid #252525; box-shadow:0 0 0 4px rgba(0,0,0,.06); }

  .cs-arrow{
    flex:0 0 auto; width:20px; height:20px; margin-left:8px;
    background:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="%23707070" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>') no-repeat center/20px 20px;
    transition:transform .15s;
  }
  .cs[aria-expanded="true"] .cs-arrow{ transform:rotate(180deg); }

  /* 패널: 기본 숨김 → 열리면 보임 */
  .cs-panel{
    display:none;
    position:absolute; left:0; right:0; top:calc(100% + 8px);
    background:#fff; border:1px solid #e5e7eb; border-radius:12px;
    box-shadow:0 12px 24px rgba(0,0,0,.12);
    padding:10px; z-index:1000;
    max-height:280px; overflow:auto;
    font-size:14px; line-height:1.5;
  }
  .cs[aria-expanded="true"] .cs-panel{ display:block; }

  /* 옵션 */
  .cs-option{
    display:flex; align-items:center; justify-content:space-between;
    padding:10px 14px; border-radius:10px; cursor:pointer;
  }
  .cs-option + .cs-option{ margin-top:4px; }
  .cs-option:hover{ background:#f5f5f5; }
  .cs-option[aria-selected="true"]{ background:#f7f7f7; font-weight:600; }

  /* 비활성(placeholder/disabled) */
  .cs-option[aria-disabled="true"]{ color:#9ca3af; cursor:default; }
  .cs-option[aria-disabled="true"]:hover{ background:transparent; }

  /* 체크마크 */
  .cs-check{
    width:18px; height:18px; margin-left:12px; visibility:hidden;
    background:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="%23252525" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>') no-repeat center/18px 18px;
  }
  .cs-option[aria-selected="true"] .cs-check{ visibility:visible; }


  /* 스크롤바(옵션 많을 때) */
  .cs-panel::-webkit-scrollbar{ width:10px; }
  .cs-panel::-webkit-scrollbar-thumb{ background:#e5e7eb; border-radius:8px; }
  .cs-panel::-webkit-scrollbar-track{ background:transparent; }

  /* 키보드 포커스 */
  .cs-option:focus{ outline:2px solid rgba(0,0,0,.12); outline-offset:2px; }

  /* 라벨 옆 필수 뱃지 */
  .opt-badge{
    display:inline-block; margin-top:-2px; margin-left:4px; padding:4px 8px; font-size:12px; line-height:1;
    border-radius:999px; color:#fff; background:#D93136; vertical-align:middle; font-weight:500;
  }

  /* 하단 CTA */
  .cta-bar{ position:relative; left:0; right:0; bottom:0; background:var(--dark); z-index:50; }
  .cta{
    width:100%; background:#252525; color:#fff; font-size:24px; font-weight:700;
    display:flex; align-items:center; justify-content:center; gap:8px; padding:24px 40px; cursor:pointer;
  }
  .cta .icon{
    width:26px; height:26px; border:1px solid #fff; border-radius:9999px;
    display:inline-flex; align-items:center; justify-content:center; font-size:14px; line-height:1;
  }
  .cta:disabled{ opacity:.6; cursor:not-allowed; }

  /* 반응형 */
  @media (max-width:1279px){ .wrap{ grid-template-columns:1fr; gap:24px; } .left{ width:auto; } }
  @media (max-width:1279px){ .row-2col{ grid-template-columns:1fr; } }
  @media (max-width:799px){
    .tiles{ grid-template-columns:repeat(2, minmax(0,1fr)); }
    .group[data-name="purpose"] .tiles{ grid-template-columns:1fr!important; }
    .cs-panel{ max-height:320px; }
    .section{ padding:56px 20px !important;}
    .group { margin-bottom: 24px !important; }
  }
 
</style>


  <!-- ✅ Flatpickr CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">

</head>
<body>
  <div class="container">
    <form id="titleForm">
      <!-- 1) 제목 -->
      <section class="wrap section" aria-label="프로젝트 제목 입력">
        <div class="left" aria-hidden="true">
          <div class="step">1</div>
          <h2>프로젝트 제목을 입력하세요</h2>
        </div>
        <div class="right">
          <div class="group" style="margin: 0;">
            <label for="title">프로젝트 제목</label>
            <input id="title" name="title" class="input" placeholder="예) 뉴미디어 XR 캠페인" autocomplete="off" />
          </div>
        </div>
      </section>

      <!-- 2) 목적: 아이콘 + 텍스트, 다중 선택 -->
      <section class="wrap section" aria-label="프로젝트의 유형 선택">
        <div class="left" aria-hidden="true" style="align-items: flex-start;">
          <div class="step">2</div>
          <div class="title-wrap">
           <h2>프로젝트의 유형을 선택하세요</h2>
           <p class="help">프로젝트와 관련이 높은 카테고리를 선택해 주세요.</p>
          </div>
        </div>

        <div class="right">
          <div class="group" data-name="purpose" data-multi="true">
            <h3>목적</h3>
            <div class="tiles">
              <div class="tile" data-value="브랜드 홍보"><span class="icon"><img src="https://raw.githubusercontent.com/XRConnect/XR-Connect---Assets/main/brand.svg"
		data-src="https://raw.githubusercontent.com/XRConnect/XR-Connect---Assets/main/brand.svg"
		data-active="https://raw.githubusercontent.com/XRConnect/XR-Connect---Assets/main/brand_l.svg"
		alt="brand" width="56" height="57" loading="lazy" decoding="async"/></span><span class="label">브랜드 홍보</span></div>
              <div class="tile" data-value="제품 홍보"><span class="icon"><img src="https://raw.githubusercontent.com/XRConnect/XR-Connect---Assets/main/product.svg"
		data-src="https://raw.githubusercontent.com/XRConnect/XR-Connect---Assets/main/product.svg"
		data-active="https://raw.githubusercontent.com/XRConnect/XR-Connect---Assets/main/product_l.svg"
		alt="product" width="56" height="57" loading="lazy" decoding="async"/></span><span class="label">제품 홍보</span></div>
              <div class="tile" data-value="이벤트 / 행사"><span class="icon"><img src="https://raw.githubusercontent.com/XRConnect/XR-Connect---Assets/main/event.svg"
		data-src="https://raw.githubusercontent.com/XRConnect/XR-Connect---Assets/main/event.svg"
		data-active="https://raw.githubusercontent.com/XRConnect/XR-Connect---Assets/main/event_l.svg"
		 alt="event" width="56" height="57" loading="lazy" decoding="async"/></span><span class="label">이벤트/행사</span></div>
              <div class="tile" data-value="디지털 트윈"><span class="icon"><img src="https://raw.githubusercontent.com/XRConnect/XR-Connect---Assets/main/digitaltwin.svg"
		data-src="https://raw.githubusercontent.com/XRConnect/XR-Connect---Assets/main/digitaltwin.svg"
		data-active="https://raw.githubusercontent.com/XRConnect/XR-Connect---Assets/main/digitaltwin_l.svg"
		 alt="digitaltwin" width="56" height="57" loading="lazy" decoding="async"/></span><span class="label">디지털 트윈</span></div>
              <div class="tile" data-value="미디어 아트"><span class="icon"><img src="https://raw.githubusercontent.com/XRConnect/XR-Connect---Assets/main/mediaart.svg"
		data-src="https://raw.githubusercontent.com/XRConnect/XR-Connect---Assets/main/mediaart.svg"
		data-active="https://raw.githubusercontent.com/XRConnect/XR-Connect---Assets/main/mediaart_l.svg"
		alt="mediaart." width="56" height="57" loading="lazy" decoding="async"/></span><span class="label">미디어 아트</span></div>
              <div class="tile" data-value="AI 콘텐츠"><span class="icon"><img src="https://raw.githubusercontent.com/XRConnect/XR-Connect---Assets/main/ai.svg"
		data-src="https://raw.githubusercontent.com/XRConnect/XR-Connect---Assets/main/ai.svg"
		data-active="https://raw.githubusercontent.com/XRConnect/XR-Connect---Assets/main/ai_l.svg"
		alt="ai" width="56" height="57" loading="lazy" decoding="async"/></span><span class="label">AI 콘텐츠</span></div>
              <div class="tile" data-value="기타"><span class="icon"><img src="https://raw.githubusercontent.com/XRConnect/XR-Connect---Assets/main/etc.svg"
		data-src="https://raw.githubusercontent.com/XRConnect/XR-Connect---Assets/main/etc.svg"
		data-active="https://raw.githubusercontent.com/XRConnect/XR-Connect---Assets/main/etc_l.svg"
		alt="etc" width="56" height="57" loading="lazy" decoding="async"/></span><span class="label">기타</span></div>
            </div>
          </div>

          <!-- 산업 (다중 선택) -->
          <div class="group" data-name="industries" data-multi="true">
            <h3>산업</h3>
            <div class="chips">
              <div class="chip" data-value="리테일/패션">리테일 / 패션</div>
              <div class="chip" data-value="디지털/가전">디지털 / 가전</div>
              <div class="chip" data-value="인테리어/가구">인테리어 / 가구</div>
              <div class="chip" data-value="문화/예술/전시">문화 / 예술 / 전시</div>
              <div class="chip" data-value="모빌리티/자동차">모빌리티 / 자동차</div>
              <div class="chip" data-value="엔터테인먼트">엔터테인먼트</div>
              <div class="chip" data-value="건설/부동산">건설 / 부동산</div>
              <div class="chip" data-value="제약/의료/헬스케어">제약 / 의료 / 헬스케어</div>
              <div class="chip" data-value="교육/훈련">교육 / 훈련</div>
              <div class="chip" data-value="제조/생산">제조 / 생산</div>
              <div class="chip" data-value="IT/통신/환경">IT / 통신 / 환경</div>
              <div class="chip" data-value="관광/레저/스포츠">관광 / 레저 / 스포츠</div>
              <div class="chip" data-value="공공/행정/국방">공공 / 행정 / 국방</div>
              <div class="chip" data-value="기타">기타</div>
            </div>
          </div>

          <!-- 콘텐츠 (다중 선택) -->
          <div class="group" data-name="contents" data-multi="true">
            <h3>콘텐츠</h3>
            <div class="chips">
              <div class="chip" data-value="3D 그래픽">3D 그래픽</div>
              <div class="chip" data-value="3D 스캔">3D 스캔</div>
              <div class="chip" data-value="360 실사촬영">360 실사촬영</div>
              <div class="chip" data-value="AI 콘텐츠">AI 콘텐츠</div>
              <div class="chip" data-value="기타">기타</div>
            </div>
          </div>

          <!-- 디바이스 (다중 선택) -->
          <div class="group" data-name="devices" data-multi="true">
            <h3>디바이스</h3>
            <div class="chips">
              <div class="chip" data-value="PC">PC</div>
              <div class="chip" data-value="모바일">모바일</div>
              <div class="chip" data-value="HMD">HMD</div>
              <div class="chip" data-value="키오스크">키오스크</div>
              <div class="chip" data-value="사이니지">사이니지</div>
              <div class="chip" data-value="프로젝터">프로젝터</div>
              <div class="chip" data-value="기타">기타</div>
            </div>
          </div>

          <!-- 자유 입력 -->
          <div class="group">
            <h3>다른 궁금하신 내용이 있으시면 입력해주세요</h3>
            <textarea class="textarea" name="note" placeholder="내용을 입력해주세요."></textarea>
          </div>

          <!-- 숨은 필드: 선택값 CSV -->
          <input type="hidden" name="purpose" />
          <input type="hidden" name="industries" />
          <input type="hidden" name="contents" />
          <input type="hidden" name="devices" />
        </div>
      </section>
      <!-- 3) 참고 자료 -->
<section class="wrap section" aria-label="참고 자료가 있으신가요?">
  <div class="left" aria-hidden="true" style="align-items: flex-start;">
    <div class="step">3</div>
    <div class="title-wrap">
      <h2>참고 자료가 있으신가요?</h2>
      <!-- 필요하면 안내문 추가 가능
      <p class="help">보유하신 자료를 선택하고 링크나 설명을 남겨 주세요.</p>
      -->
    </div>
  </div>

  <div class="right">
    <!-- 보유 리소스 (다중 선택, '없음'은 배타 선택) -->
    <div class="group" data-name="resources" data-multi="true">
      <h3>보유 리소스</h3>
      <div class="chips">
        <div class="chip" data-value="도면 / 설계 자료">도면 / 설계 자료</div>
        <div class="chip" data-value="3D 소스">3D 소스</div>
        <div class="chip" data-value="참고 이미지 / 영상">참고 이미지 / 영상</div>
        <div class="chip" data-value="기타">기타</div>
        <div class="chip" data-value="없음 (올인원 신청)" data-exclusive="true">없음 (올인원 신청)</div>
      </div>
    </div>

    <!-- 링크/설명 -->
    <div class="group">
      <h3>레퍼런스 / 요구사항 링크가 있나요?</h3>
      <textarea class="textarea" name="reference" placeholder="URL or 기타 설명"></textarea>
    </div>

    <!-- 숨은 필드: 선택값 CSV -->
    <input type="hidden" name="resources" />
  </div>
</section>

<!-- 4) 일정과 예산 -->
<section class="wrap section" aria-label="일정과 예산을 선택하세요">
  <div class="left" aria-hidden="true" style="align-items: flex-start;">
    <div class="step">4</div>
    <div class="title-wrap">
      <h2>일정과 예산을 선택하세요</h2>
    </div>
  </div>

  <div class="right">
  <div class="field-stack">
    <!-- 묶음 #1: 날짜 2개 -->
    <div class="row-2col">
      <div class="group">
        <label for="startDate">희망 시작일</label>
        <input id="startDate" name="start_date" type="text" class="input" placeholder="연도 - 월 - 일" />
      </div>
      <div class="group">
        <label for="endDate">런칭 / 마감일</label>
        <input id="endDate" name="end_date" type="text" class="input" placeholder="연도 - 월 - 일" />
      </div>
    </div>

    <!-- 묶음 #2: 예산 / NDA -->
    <div class="row-2col">
      <div class="group">
        <label for="budget">예산 구간</label>
         <select id="budget" name="budget" class="input" data-enhance="select">
           <option value="" selected disabled>선택하세요</option>
           <option value="~1천만원">~ 1천만원</option>
           <option value="1천만~3천만원">1천만 ~ 3천만원</option>
           <option value="3천만~5천만원">3천만 ~ 5천만원</option>
           <option value="5천만~1억원">5천만 ~ 1억원</option>
           <option value="1억원 이상">1억원 이상</option>
           <option value="미정">미정</option>
         </select>
      </div>
      <div class="group">
        <label for="nda">NDA(비밀유지) 필요 여부</label>
        <select id="nda" name="nda" class="input" data-enhance="select">
          <option value="" selected disabled>선택하세요</option>
          <option value="필요">필요</option>
          <option value="불필요">불필요</option>
          <option value="논의 필요">논의 필요</option>
        </select>
      </div>
    </div>
  </div>
</div>
</section>
<!-- 5) 기본 정보 -->
<section class="wrap section" aria-label="기본 정보를 입력하세요" style="padding-bottom: 120px !important;">
  <div class="left" aria-hidden="true" style="align-items: flex-start;">
    <div class="step">5</div>
    <div class="title-wrap">
      <h2>기본 정보를 입력하세요</h2>
    </div>
  </div>

  <div class="right">
    <div class="field-stack">
      <div class="row-2col">
        <div class="group">
          <label for="contactName">담당자 이름<span class="opt-badge">필수</span></label>
          <input id="contactName" name="contact_name" type="text" class="input" required placeholder="이름" autocomplete="name" />
        </div>

        <div class="group">
          <label for="email">이메일<span class="opt-badge">필수</span></label>
          <input id="email" name="email" type="email" class="input" required placeholder="you@mail.com" autocomplete="email" />
          <!-- 브라우저 기본 에러를 쓰되, setCustomValidity로 한국어 문구 지정 -->
        </div>
      </div>

      <div class="row-2col">
        <div class="group">
          <label for="phone">연락처<span class="opt-badge">필수</span></label>
          <input id="phone" name="phone" type="tel" class="input" inputmode="numeric" autocomplete="tel" placeholder="010-0000-0000" required />
        </div>
        <div class="group">
          <label for="company">회사명<span class="opt-badge">필수</span></label>
          <input id="company" name="company" type="text" class="input" placeholder="" autocomplete="organization" required />
        </div>
      </div>
    </div>
  </div>
</section>
    </form>
  </div>

  <!-- 하단 100% 등록하기 버튼 -->
  <div class="cta-bar">
    <button id="submitBtn" class="cta" form="titleForm" type="submit">
      등록하기 <span class="icon">→</span>
    </button>
  </div>
 <!-- body 끝부분: Flatpickr JS → 우리 스크립트 순서 -->

<!-- Flatpickr loader -->
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
<script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/ko.js"></script>
<script>
  /** =========================
   *  Flatpickr (섹션4 날짜)
   *  ========================= */
  // 전역 인스턴스
  let fpStart, fpEnd;

  window.addEventListener('DOMContentLoaded', () => {
    fpStart = flatpickr("#startDate", {
      locale: flatpickr.l10ns.ko,
      dateFormat: "Y-m-d",        // submit 값
      altInput: true,
      altFormat: "Y년 m월 d일",     // 표시용
      altInputClass: "input",      // 기존 .input 룩 적용
      enableTime: false,
      disableMobile: true,
      onReady: (dates, str, instance) => { instance.altInput.placeholder = "연도 - 월 - 일"; },
      onChange: (sel) => { if (sel[0] && fpEnd) fpEnd.set("minDate", sel[0]); } // ✅ 가드 추가
    });

    fpEnd = flatpickr("#endDate", {
      locale: flatpickr.l10ns.ko,
      dateFormat: "Y-m-d",
      altInput: true,
      altFormat: "Y년 m월 d일",
      altInputClass: "input",
      enableTime: false,
      disableMobile: true,
      onReady: (dates, str, instance) => { instance.altInput.placeholder = "연도 - 월 - 일"; }
    });
  });
</script>
<script>
  // 섹션4 두 셀렉트를 대상
  const selects = [document.getElementById('budget'), document.getElementById('nda')].filter(Boolean);

  function updatePlaceholderState(sel){
    const isEmpty = !sel.value || sel.value === '';
    sel.classList.toggle('placeholder', isEmpty);
  }
  selects.forEach(sel=>{
    updatePlaceholderState(sel);
    // 포커스 아웃하면 '만짐' 표시 (유효성 스타일과 동일한 UX)
    sel.addEventListener('blur', ()=> sel.classList.add('user-touched'));
    sel.addEventListener('change', ()=> updatePlaceholderState(sel));
  });
</script>
<script>
/* ===== Custom Select (접근성 + 동기화) ===== */
(function(){
  const sels = document.querySelectorAll('select.input[data-enhance="select"]');
  sels.forEach(sel => {
    if (sel.closest('.cs')) return; // 이미 래핑된 경우 스킵
    makeCustom(sel);
  });

  function makeCustom(sel){
    const wrap = document.createElement('div');
    wrap.className = 'cs';
    wrap.setAttribute('role','combobox');
    wrap.setAttribute('aria-haspopup','listbox');
    wrap.setAttribute('aria-expanded','false');

    const trigger = document.createElement('button');
    trigger.type = 'button';
    trigger.className = 'cs-trigger';
    const label = document.createElement('span');
    label.textContent = sel.options[sel.selectedIndex]?.text || '선택하세요';
    if (!sel.value) label.classList.add('cs-placeholder');
    const arrow = document.createElement('span'); arrow.className='cs-arrow';
    trigger.append(label, arrow);

    const panel = document.createElement('div');
    panel.className = 'cs-panel';
    panel.setAttribute('role','listbox');

    // 옵션 렌더링
    Array.from(sel.options).forEach((opt)=>{
      const isPlaceholder = (opt.value === '' || opt.disabled);
      const item = document.createElement('div');
      item.className = 'cs-option';
      item.setAttribute('role','option');
      item.dataset.value = opt.value;
      item.setAttribute('tabindex', isPlaceholder ? '-1' : '0');
      if (isPlaceholder) item.setAttribute('aria-disabled','true');

      const text = document.createElement('span');
      text.textContent = opt.textContent;
      if (isPlaceholder) text.style.color = '#9ca3af';

      const check = document.createElement('span');
      check.className = 'cs-check';

      item.append(text, check);

      // 초기 선택 상태(placeholder는 선택 표시 X)
      if (!isPlaceholder && opt.selected) item.setAttribute('aria-selected','true');

      // placeholder/disabled는 클릭 불가
      if (!isPlaceholder) {
        item.addEventListener('click', ()=>{
          selectValue(opt.value);
          close();
          trigger.focus();
        });
        item.addEventListener('keydown', (ev)=>{
          if (ev.key === 'Enter' || ev.key === ' ') { ev.preventDefault(); item.click(); }
        });
      }

      panel.appendChild(item);
    });

    // DOM 배치
    sel.parentNode.insertBefore(wrap, sel);
    wrap.appendChild(sel);
    wrap.appendChild(trigger);
    wrap.appendChild(panel);

    // 열기/닫기
    function open(){
      wrap.setAttribute('aria-expanded','true');
      focusSelected();
      document.addEventListener('click', onDocClick, { once:true });
      document.addEventListener('keydown', onKey);
    }
    function close(){
      wrap.setAttribute('aria-expanded','false');
      document.removeEventListener('keydown', onKey);
    }
    function onDocClick(e){
      if (!wrap.contains(e.target)) close();
      else document.addEventListener('click', onDocClick, { once:true });
    }
    function onKey(e){
      if (e.key === 'Escape') { close(); trigger.focus(); }
      if (e.key === 'ArrowDown' || e.key === 'ArrowUp'){
        e.preventDefault(); moveFocus(e.key === 'ArrowDown' ? 1 : -1);
      }
    }
    trigger.addEventListener('click', ()=>{
      const isOpen = wrap.getAttribute('aria-expanded') === 'true';
      isOpen ? close() : open();
    });

    // 값 선택
    function selectValue(val){
      const nativeOpt = Array.from(sel.options).find(o => o.value === val);
      if (!nativeOpt || nativeOpt.disabled || val === '') return;

      const opts = Array.from(panel.querySelectorAll('.cs-option'));
      opts.forEach(o => o.removeAttribute('aria-selected'));
      const target = opts.find(o=>o.dataset.value===val);
      if (target) target.setAttribute('aria-selected','true');

      sel.value = val;
      sel.dispatchEvent(new Event('change', { bubbles:true }));

      label.textContent = nativeOpt.textContent;
      label.classList.toggle('cs-placeholder', !val);
    }

    // 포커스 유틸
    function focusSelected(){
      const current =
        panel.querySelector('.cs-option[aria-selected="true"]') ||
        panel.querySelector('.cs-option:not([aria-disabled="true"])');
      if (current) current.focus();
    }
    function moveFocus(dir){
      const items = Array.from(panel.querySelectorAll('.cs-option'));
      let idx = items.indexOf(document.activeElement);
      if (idx < 0) idx = 0;
      let nextIdx = Math.min(items.length-1, Math.max(0, idx + dir));
      // disabled는 건너뛰기
      while (items[nextIdx] && items[nextIdx].getAttribute('aria-disabled') === 'true') {
        nextIdx = Math.min(items.length-1, Math.max(0, nextIdx + dir));
        if (nextIdx === idx) break;
      }
      if (items[nextIdx]) items[nextIdx].focus();
    }

    // 네이티브 값 변경과 동기화(초기 상태 포함)
    sel.addEventListener('change', ()=>{
      const val = sel.value || '';
      const opt = Array.from(sel.options).find(o=>o.value===val) || sel.options[0];
      label.textContent = opt.textContent;
      label.classList.toggle('cs-placeholder', !val);
      Array.from(panel.querySelectorAll('.cs-option')).forEach(o=>{
        o.toggleAttribute('aria-selected', o.dataset.value===val);
      });
    });
    sel.dispatchEvent(new Event('change'));
  }
})();
</script>
<script>
window.addEventListener('DOMContentLoaded', () => {
  // ❶ 인풋을 만졌는지 표시(blur 시)
  document.querySelectorAll('.input').forEach(el => {
    el.addEventListener('blur', () => el.classList.add('user-touched'));
  });

  /** =========================
   *  공통 변수/유틸
   *  ========================= */
  const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbydgL1hWh_ZKbJdkLB_K8le1DG8jAKXgx6oe1loNZjff2lA8zadYBpkycmXmmm85PkV1A/exec';
  const form = document.getElementById('titleForm');
  const submitBtn = document.getElementById('submitBtn');

  const setPressed = (el, pressed) => el.setAttribute('aria-pressed', pressed ? 'true' : 'false');

  function updateHiddenFromGroup(group){
    const name = group.dataset.name;
    if (!name) return;
    const multi = group.dataset.multi === 'true';
    const active = [...group.querySelectorAll('.tile.active, .chip.active')].map(el => el.dataset.value);
    const hidden = form.querySelector(`input[name="${name}"]`);
    if (hidden) hidden.value = multi ? active.join(', ') : (active[0] || '');
  }
  function updateTileIcon(tile){
    const img = tile.querySelector('img[data-src][data-active]');
    if (!img) return;
    const next = tile.classList.contains('active') ? img.dataset.active : img.dataset.src;
    if (img.src !== next) img.src = next;
  }

  /** =========================
   *  선택 로직 + 접근성 + 배타 칩
   *  ========================= */
  function initSelectable(){
    document.querySelectorAll('.group[data-name]').forEach(group => {
      group.querySelectorAll('.tile, .chip').forEach(el => setPressed(el, el.classList.contains('active')));
      group.addEventListener('click', (e)=>{
        const el = e.target.closest('.tile, .chip');
        if (!el || el.hasAttribute('disabled') || el.classList.contains('disabled')) return;

        const multi = group.dataset.multi === 'true';
        if (multi) {
          el.classList.toggle('active');
          setPressed(el, el.classList.contains('active'));
          if (el.classList.contains('tile')) updateTileIcon(el);
        } else {
          group.querySelectorAll('.tile.active, .chip.active').forEach(n => {
            n.classList.remove('active'); setPressed(n, false); if (n.classList.contains('tile')) updateTileIcon(n);
          });
          el.classList.add('active'); setPressed(el, true); if (el.classList.contains('tile')) updateTileIcon(el);
        }

        if (group.dataset.name === 'resources') {
          const isExclusive = el.dataset.exclusive === 'true';
          const noneChip = group.querySelector('.chip[data-exclusive="true"]');
          if (isExclusive) {
            group.querySelectorAll('.chip.active').forEach(n => { if (n !== el) { n.classList.remove('active'); setPressed(n, false); }});
          } else if (noneChip && noneChip.classList.contains('active')) {
            noneChip.classList.remove('active'); setPressed(noneChip, false);
          }
        }
        updateHiddenFromGroup(group);
      });
    });
    document.querySelectorAll('.tile').forEach(updateTileIcon);
  }
  initSelectable();

  // 아이콘 프리로드
  ;(function preloadActiveIcons(){
    const urls = Array.from(document.querySelectorAll('.tile img[data-active]'))
      .map(img => img.dataset.active)
      .filter(Boolean);
    urls.forEach(src => { const i = new Image(); i.src = src; });
  })();

  /** =========================
   *  섹션5: 이메일/연락처 유효성 (리스너는 제출 바깥!)
   *  ========================= */
  const emailEl = document.getElementById('email');
  const phoneEl = document.getElementById('phone');

  if (emailEl) {
    const setEmailValidity = () => {
      emailEl.setCustomValidity('');
      if (emailEl.value.trim() === '') return;
      if (!emailEl.checkValidity()) emailEl.setCustomValidity('올바른 이메일 주소를 입력해 주세요.');
    };
    emailEl.addEventListener('input', setEmailValidity);
    emailEl.addEventListener('invalid', setEmailValidity);
    emailEl.addEventListener('blur', setEmailValidity);
  }

  if (phoneEl) {
    const formatPhone = (digits) => {
      if (digits.length <= 3) return digits;
      if (digits.length <= 7) return `${digits.slice(0,3)}-${digits.slice(3)}`;
      return `${digits.slice(0,3)}-${digits.slice(3,7)}-${digits.slice(7,11)}`;
    };
    const setPhoneValidityAndFormat = () => {
      let digits = phoneEl.value.replace(/\D/g, '');
      phoneEl.value = formatPhone(digits);
      phoneEl.setCustomValidity('');
      if (digits.length === 0) return;
      if (!digits.startsWith('010')) phoneEl.setCustomValidity('연락처는 010으로 시작해야 합니다.');
      else if (digits.length < 11) phoneEl.setCustomValidity('연락처는 숫자 11자리(010 포함) 이상이어야 합니다.');
    };
    phoneEl.addEventListener('input', setPhoneValidityAndFormat);
    phoneEl.addEventListener('blur', setPhoneValidityAndFormat);
    phoneEl.addEventListener('invalid', setPhoneValidityAndFormat);
  }

  /** =========================
   *  제출
   *  ========================= */
  form.addEventListener('submit', async (e) => {
    e.preventDefault();

    if (submitBtn.disabled) return;
    form.classList.add('was-validated');           // 제출 시도 → 에러 스타일 표시
    if (!form.reportValidity()) return;            // ✅ 한 번만 호출

    document.querySelectorAll('.group[data-name]').forEach(updateHiddenFromGroup);

    submitBtn.disabled = true;
    try {
      const params = new URLSearchParams(new FormData(form));
      const res = await fetch(SCRIPT_URL, { method:'POST', body: params });
      let data = null; try { data = await res.json(); } catch(_) {}
      if (!res.ok || (data && data.ok === false)) {
        const msg = (data && data.error) ? data.error : 'Network or server error';
        throw new Error(msg);
      }

      alert('문의가 등록되었습니다✅. 감사합니다🙇‍♂️');

      // 상태/값 리셋
      form.classList.remove('was-validated');
      document.querySelectorAll('.input').forEach(el => el.classList.remove('user-touched'));

      form.reset();
      document.querySelectorAll('.tile.active, .chip.active').forEach(n => {
        n.classList.remove('active'); setPressed(n, false);
        if (n.classList.contains('tile')) updateTileIcon(n);
      });
      if (fpStart) fpStart.clear();
      if (fpEnd) { fpEnd.clear(); fpEnd.set('minDate', null); }
      document.querySelectorAll('.group[data-name]').forEach(updateHiddenFromGroup);

    } catch (err) {
      console.error(err);
      alert('전송 실패: ' + err.message);
    } finally {
      submitBtn.disabled = false;
    }
  });
});</script>
</body>
</html>
